@ECHO OFF

python .\src\ip_host.py
IF ERRORLEVEL 1 (
    CALL :KILLSCRIPT
    EXIT /B %ERRORLEVEL%
)

START /D . /MIN "SERVIDOR HTTP" python -m http.server
START /D . /MIN "SERVIDOR FTP" python -m pyftpdlib
START "GERADOR" python .\src\pacotes.py

CHOICE /C T /N /M "PRESSIONE T PARA [T]ERMINAR O PROGRAMA"
IF ERRORLEVEL 1 (
    CALL :KILLSCRIPT
    EXIT /B %ERRORLEVEL%
)

:KILLSCRIPT
    TASKKILL /FI "WINDOWTITLE EQ SERVIDOR HTTP"
    TASKKILL /FI "WINDOWTITLE EQ SERVIDOR FTP"
    TASKKILL /FI "WINDOWTITLE EQ GERADOR"
    EXIT /B %ERRORLEVEL%
